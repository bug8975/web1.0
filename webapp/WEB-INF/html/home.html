<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>主页</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
		<meta name="description" content="">
		<meta name="author" content="">
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/css/cloud-admin.css">
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/css/themes/default.css" id="skin-switcher">
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/css/responsive.css">

		<!-- STYLESHEETS -->
		<!--[if lt IE 9]><script src="js/flot/excanvas.min.js"></script><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script><![endif]-->
		<link href="$!webPath/resources/bootstrap/font-awesome/css/font-awesome.min.css" rel="stylesheet">
		<!-- ANIMATE -->
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/css/animatecss/animate.min.css" />
		<!-- DATE RANGE PICKER -->
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/js/bootstrap-daterangepicker/daterangepicker-bs3.css" />
		<!-- TODO -->
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/js/jquery-todo/css/styles.css" />
		<!-- FULL CALENDAR -->
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/js/fullcalendar/fullcalendar.min.css" />
		<!-- GRITTER -->
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/js/gritter/css/jquery.gritter.css" />
		<!-- 自定义CSS样式 -->
		<link rel="stylesheet" type="text/css" href="$!webPath/resources/bootstrap/css/custom/default.css">
	</head>
	<body>
		<!-- 头部页眉 -->
		$!httpInclude.include("/common/top.htm")
		<!-- over -->

		<!-- PAGE -->
		<section id="page">
			<!-- 侧边栏 -->
			$!httpInclude.include("/common/menu_nav.htm")
			<!-- over -->
			<div id="main-content">
				<!-- SAMPLE BOX CONFIGURATION MODAL FORM-->

				<!-- /SAMPLE BOX CONFIGURATION MODAL FORM-->
				<div class="container">
					<div class="row">
						<div id="content" class="col-lg-12">
							<!-- PAGE HEADER-->
							<div class="row">
								<div class="col-sm-12">
									<div id="mypageheader">
										<ul class="breadcrumb">
											<li>
												<i class="fa fa-home"></i>
												<a href="home.html">主页</a>
											</li>
											<li>数据看板</li>
										</ul>
									</div>
								</div>
							</div>
							<!-- /PAGE HEADER -->
							<!-- DASHBOARD CONTENT -->
							<!-- 数据看板 -->
							<!-- DASHBOARD CONTENT -->
							<div class="row">
								<!-- COLUMN 1 -->
								<div class="col-md-6">
									<div class="row">
										<div class="col-lg-6">
											<div class="dashbox panel panel-default">
												<div class="panel-body">
													<div class="panel-left red">
														<i class="fa fa-instagram fa-3x"></i>
													</div>
													<div class="panel-right">
														<div class="number">6718</div>
														<div class="title">Likes</div>
														<span class="label label-success">
															26% <i class="fa fa-arrow-up"></i>
														</span>
													</div>
												</div>
											</div>
										</div>
										<div class="col-lg-6">
											<div class="dashbox panel panel-default">
												<div class="panel-body">
													<div class="panel-left blue">
														<i class="fa fa-twitter fa-3x"></i>
													</div>
													<div class="panel-right">
														<div class="number">2724</div>
														<div class="title">Followers</div>
														<span class="label label-warning">
															5% <i class="fa fa-arrow-down"></i>
														</span>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="row">
										<div class="col-md-12">
											<div class="quick-pie panel panel-default">
												<div class="panel-body">
													<div class="col-md-4 text-center">
														<div id="dash_pie_1" class="piechart" data-percent="59">
															<span class="percent"></span>
														</div>
														<a href="#" class="title">New Visitors <i class="fa fa-angle-right"></i></a>
													</div>
													<div class="col-md-4 text-center">
														<div id="dash_pie_2" class="piechart" data-percent="73">
															<span class="percent"></span>
														</div>
														<a href="#" class="title">Bounce Rate <i class="fa fa-angle-right"></i></a>
													</div>
													<div class="col-md-4 text-center">
														<div id="dash_pie_3" class="piechart" data-percent="90">
															<span class="percent"></span>
														</div>
														<a href="#" class="title">Brand Popularity <i class="fa fa-angle-right"></i></a>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- /COLUMN 1 -->

								<!-- COLUMN 2 -->
								<div class="col-md-6">

									<div class="row">
										<div class="box solid grey">
											<div class="box-title">
												<div class="form-inline">
													<h4><i class="fa fa-dollar"></i>实时曲线</h4>
												</div>
												<div class="form-inline">
													<div class="tools">
														<a href="javascript:;" class="reload">
															<i class="fa fa-refresh"></i>
														</a>
													</div>	
												</div>
												<div class="form-inline">
													<form method="post" name="ListForm" id="ListForm">
														<div class="ordersear">
															<span>传感器类型:</span> 
															<span class="ordersel"> 
																<select name="sensorTypeName" id="sensorTypeName">
																		<option value="" selected="selected">请选择</option>
																		#foreach($sensorType in $sensorTypes)
																		<option value="$!sensorType.name"
																			#if($!sensorTypeName==$!sensorType.name)
																			selected="selected" #end>$!sensorType.displayName</option>
																		#end
																</select>
															</span> 
															<span>&nbsp;&nbsp;&nbsp;监测线:</span> 
															<span class="ordersel">
																<select name="monitorlineid" id="monitorlineid">
																	<option value="" selected="selected">请选择</option>
																	#foreach($monitorline in $monitorLines)
																	<option value="$!monitorline.id"
																		#if($!monitorlineid==$!monitorline.id)
																		selected="selected" #end>$!monitorline.name</option>
																	#end
																</select>
																<span class="px10">&nbsp;&nbsp;&nbsp;变&nbsp;化&nbsp;范&nbsp;围:&nbsp;</span>
																<span id="range"> 
																	<input id="rangeability"
																	maxlength="6" autocomplete="on" placeholder="上下限" style=""
																	disabled="disabled" size="10"
																	onblur="generateSinkingDataLine()"
																	onkeyup="this.value=this.value.replace(/[^\- \d.]/g,'')" />
																</span>
															</span> 
															<span class="orderbtn" id="orderbtn"> 
																<input name="" type="button" value="生成曲线"
																style="cursor: pointer;" href="/home.htm"
																onclick="generateSinkingDataLine()" />
															</span>
														</div>
													</form>
												</div>																												
											</div>
											<div class="box-body">
												<div class="operation">	
													<div style="margin-bottom: 15px">
														<table width="1039" border="0" cellspacing="0"
															cellpadding="0" id="opertable">
															<tr id="opertitle">
																<td></td>
															</tr>
														</table>
														<div id="container" style="height: 550px; overflow: auto;"></div>
													</div>
												</div>		
												<!-- <canvas id="myChart" width="100%" height="100%"></canvas>										 -->
											</div>
										</div>
									</div>
								</div>
								<!-- /COLUMN 2 -->
							</div>
							<!-- /DASHBOARD CONTENT -->
							<!-- HERO GRAPH -->
							<div class="row">
								<div class="col-md-12">
									<!-- BOX -->
									<div class="box border green">
										<div class="box-title">
											<div class="form-inline">
												<h4><i class="fa fa-bars"></i> <span class="hidden-inline-mobile">累计形变图</span></h4>
											</div>
											<div class="form-inline">
												<form method="post" name="ListForm" id="ListForm">
													<div class="ordersear">
														<span>传感器类型:</span> 
														<span class="ordersel"> 
															<select name="sensorTypeName" id="sensorTypeName">
																	<option value="" selected="selected">请选择</option>
																	#foreach($sensorType in $sensorTypes)
																	<option value="$!sensorType.name"
																		#if($!sensorTypeName==$!sensorType.name)
																		selected="selected" #end>$!sensorType.displayName</option>
																	#end
															</select>
														</span> 
														<span>&nbsp;&nbsp;&nbsp;监测线:</span> 
														<span class="ordersel">
															<select name="monitorlineid" id="monitorlineid">
																<option value="" selected="selected">请选择</option>
																#foreach($monitorline in $monitorLines)
																<option value="$!monitorline.id"
																	#if($!monitorlineid==$!monitorline.id)
																	selected="selected" #end>$!monitorline.name</option> #end
															</select>
														</span> 
														<span>&nbsp;&nbsp;&nbsp;传感器:</span> 
														<span class="ordersel">
															<select name="sensorid" id="sensorid">
																<option value="" selected="selected">请选择</option>
																#foreach($sensor in $sensors)
																<option value="$!sensor.id" #if($!sensorid==$!sensor.id)
																	selected="selected" #end>$!sensor.name</option> #end
															</select>
														</span> 
														<span class="px10">&nbsp;&nbsp;&nbsp;时间段:</span> 
														<span class="ordersel"> 
															<input name="beginTime"
															type="text" id="beginTime" value="$!beginTime"
															readonly="readonly" style="width: 80px;" />
														</span> 
														<span>-</span> 
														<span class="ordersel"> 
															<input name="endTime" type="text" id="endTime" value="$!endTime"
															readonly="readonly" style="width: 80px;" />
														</span> 
														<span class="orderbtn"> 
															<input name="" type="button"
															value="生成曲线" style="cursor: pointer;" href="/hemo.htm"
															onclick="generateLine()" />
														</span>
													</div>
												</form>
											</div>
										</div>
										<div class="box-body">
											<div class="tabbable header-tabs">
												<ul class="nav nav-tabs">
													<li>
														<a href="#box_tab2" data-toggle="tab">
															<i class="fa fa-search-plus"></i> 
															<span class="hidden-inline-mobile">累计形变单曲线</span>
														</a>
													</li>
													<li class="active">
														<a href="#box_tab1" data-toggle="tab">
															<i class="fa fa-bar-chart-o"></i> 
															<span class="hidden-inline-mobile">累计形变多曲线</span>
														</a>
													</li>
												</ul>
												<div class="tab-content">
													<div class="operation">
														<div style="margin-bottom: 15px">
															<span class="px10">&nbsp;&nbsp;&nbsp;形变范围(Y轴):</span> <input
																id="singleMaxValue" maxlength="6" autocomplete="on"
																placeholder="形变上限" style="" size="10"
																onblur="generateLine()"
																onkeyup="this.value=this.value.replace(/[^\- \d.]/g,'')" />&nbsp;-
															<input id="singleMinValue" maxlength="6" autocomplete="on"
																placeholder="形变下限" style="" size="10"
																onblur="generateLine()"
																onkeyup="this.value=this.value.replace(/[^\- \d.]/g,'')" />
														</div>
														<table width="100%" border="0" cellspacing="0" cellpadding="0"
															id="opertable">
															<tr id="opertitle">
																<td></td>
															</tr>
														</table>
														<div id="container" style="height: 550px; min-width: 310px"></div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<!-- /BOX -->
								</div>
							</div>
							<!-- /HERO GRAPH -->
							<!-- /DASHBOARD CONTENT -->
							<div class="footer-tools">
								<span class="go-top">
									<i class="fa fa-chevron-up"></i> Top
								</span>
							</div>
						</div><!-- /CONTENT-->
					</div>
				</div>
			</div>
		</section>
		<!--/PAGE -->
		<!-- JAVASCRIPTS -->
		<!-- Placed at the end of the document so the pages load faster -->
		<!-- JQUERY -->
		<script src="$!webPath/resources/bootstrap/js/jquery/jquery-2.0.3.min.js"></script>
		<!-- JQUERY UI-->
		<script src="$!webPath/resources/bootstrap/js/jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.min.js"></script>
		<!-- BOOTSTRAP -->
		<script src="$!webPath/resources/bootstrap/bootstrap-dist/js/bootstrap.min.js"></script>
		<!-- DATE RANGE PICKER -->
		<script src="$!webPath/resources/bootstrap/js/bootstrap-daterangepicker/moment.min.js"></script>
		<script src="$!webPath/resources/bootstrap/js/bootstrap-daterangepicker/daterangepicker.min.js"></script>
		<!-- SLIMSCROLL -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/jQuery-slimScroll-1.3.0/jquery.slimscroll.min.js"></script>
		<!-- SLIMSCROLL -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/jQuery-slimScroll-1.3.0/jquery.slimscroll.min.js"></script>
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/jQuery-slimScroll-1.3.0/slimScrollHorizontal.min.js"></script>
		<!-- BLOCK UI -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/jQuery-BlockUI/jquery.blockUI.min.js"></script>
		<!-- SPARKLINES -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/sparklines/jquery.sparkline.min.js"></script>
		<!-- EASY PIE CHART -->
		<script src="$!webPath/resources/bootstrap/js/jquery-easing/jquery.easing.min.js"></script>
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/easypiechart/jquery.easypiechart.min.js"></script>
		<!-- FLOT CHARTS -->
		<script src="$!webPath/resources/bootstrap/js/flot/jquery.flot.min.js"></script>
		<script src="$!webPath/resources/bootstrap/js/flot/jquery.flot.time.min.js"></script>
		<script src="$!webPath/resources/bootstrap/js/flot/jquery.flot.selection.min.js"></script>
		<script src="$!webPath/resources/bootstrap/js/flot/jquery.flot.resize.min.js"></script>
		<script src="$!webPath/resources/bootstrap/js/flot/jquery.flot.pie.min.js"></script>
		<script src="$!webPath/resources/bootstrap/js/flot/jquery.flot.stack.min.js"></script>
		<script src="$!webPath/resources/bootstrap/js/flot/jquery.flot.crosshair.min.js"></script>
		<!-- TODO -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/jquery-todo/js/paddystodolist.js"></script>
		<!-- TIMEAGO -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/timeago/jquery.timeago.min.js"></script>
		<!-- FULL CALENDAR -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/fullcalendar/fullcalendar.min.js"></script>
		<!-- COOKIE -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/jQuery-Cookie/jquery.cookie.min.js"></script>
		<!-- GRITTER -->
		<script type="text/javascript" src="$!webPath/resources/bootstrap/js/gritter/js/jquery.gritter.min.js"></script>
		<!-- CUSTOM SCRIPT -->
		<script src="$!webPath/resources/bootstrap/js/script.js"></script>
<script type="text/javascript" src="$!webPath/resources/js/public_hj.js"></script>
<script src="$!webPath/resources/js/jquery.shop.common.js"></script>
<script src="$!webPath/resources/js/highstock.js"></script>
<script src="$!webPath/resources/js/exporting.js"></script>
		<script>
Highcharts.setOptions({ global: { useUTC: false } });
jQuery(document).ready(function(){
	//chart-two部分
	jQuery('#beginTime').datepicker({
		  dateFormat:"yy-mm-dd",
		  changeMonth: true,
		  changeYear: true,
		  monthNamesShort: ['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],
	    dayNamesMin: ['日','一','二','三','四','五','六']
	});
	jQuery('#endTime').datepicker({
		  dateFormat:"yy-mm-dd",
		  changeMonth: true,
		  changeYear: true,
		  monthNamesShort: ['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],
	    dayNamesMin: ['日','一','二','三','四','五','六']
	});
	//chart-one部分
  jQuery("#sensorTypeName").change(function(){
      //var level=jQuery(this).attr("level");
      var sensorTypeName=jQuery(this).val();
      // alert("sensorTypeName:" + sensorTypeName);
      if(sensorTypeName !="" && sensorTypeName=="FixedInclinoMeter" || sensorTypeName=="InclinoMeter"){
          $("#monitorlineid").attr("disabled","disabled");
          $("#rangeability").removeAttr("disabled");
          $("#orderbtn").empty();
          $("#orderbtn").append("<input name='' type='button' value='生成曲线' style='cursor: pointer;' onclick='createDataLine()' />");
          $("#range").empty();
          $("#range").append("<input id='rangeability' maxlength='6' autocomplete='on'  placeholder='上下限' size='10' onblur='createDataLine()' onkeyup='this.value=this.value.replace(/[^\- \d.]/g,'')'"+"/>");
          $("#rangeability").removeAttr("disabled");
      }else{
          $("#monitorlineid").removeAttr("disabled");
          $("#orderbtn").empty();
          $("#orderbtn").append("<input name='' type='button' value='生成曲线' style='cursor: pointer;' onclick='generateSinkingDataLine()' />");
          $("#range").empty();
          $("#range").append("<input id='rangeability' maxlength='6' autocomplete='on'  placeholder='上下限' size='10' onblur='generateSinkingDataLine()' onkeyup='this.value=this.value.replace(/[^\- \d.]/g,'')'"+"/>");
          $("#rangeability").attr("disabled","disabled");
      }
      if(sensorTypeName!=""){
          jQuery.post("$!webPath/load_monitorline.htm",{"sensorTypeName":sensorTypeName},function(data){
              jQuery("#monitorlineid").empty();
              jQuery("#monitorlineid").append("<option value=''>请选择</option>");
              jQuery.each(data, function(index,item){
                  jQuery("#monitorlineid").append("<option value='"+item.id+"'>"+item.monitorLineName+"</option>");
                  //jQuery("#sensor").show();
              });
              jQuery("#sensorid").empty();
              jQuery("#sensorid").append("<option value=''>请选择</option>");
          },"json");
      }else{
          jQuery("#monitorlineid").empty();
          jQuery("#monitorlineid").append("<option value=''>请选择</option>");
      }
  });
  jQuery("#monitorlineid").change(function(){
      //var level=jQuery(this).attr("level");
      
      var id=jQuery(this).val();
      if(id!=""){
          jQuery.post("$!webPath/load_sensor_without_basepoint.htm",{"pid":id},function(data){
              jQuery("#sensorid").empty();
              jQuery("#sensorid").append("<option value=''>请选择</option>");
              jQuery.each(data, function(index,item){
                  jQuery("#sensorid").append("<option value='"+item.id+"'>"+item.sensorName+"</option>");
                  //jQuery("#sensor").show();
              });
          }, "json");
      } else {
          jQuery("#sensorid").empty();
          jQuery("#sensorid").append("<option value=''>请选择</option>");
      }
  });
  document.getElementById("rangeability").value = getCookie("rangeability"); 
  //chart-two部分
  document.getElementById("singleMaxValue").value = getCookie("singleMax"); 
  document.getElementById("singleMinValue").value = getCookie("singMin");  
});

function dateFormat(timeMs, format){
    var t = new Date(timeMs);
    var tf = function(i){return (i < 10 ? '0' : '') + i};
    return format.replace(/yyyy|MM|dd|HH|mm|ss/g, function(a){
        switch(a){
            case 'yyyy':
                return tf(t.getFullYear());
                break;
            case 'MM':
                return tf(t.getMonth() + 1);
                break;
            case 'mm':
                return tf(t.getMinutes());
                break;
            case 'dd':
                return tf(t.getDate());
                break;
            case 'HH':
                return tf(t.getHours());
                break;
            case 'ss':
                return tf(t.getSeconds());
                break;
        }
    })
}

#if($!sinkingData)
	#if($!hasData == 'true')
		$(function(){
			var x_Axis = $!sinkingData;
			if( x_Axis.length <= 20){
				x_Axis = x_Axis.length-1;
			}else{
				x_Axis = 19;
			}
			
			var rangeValue;
            if(getCookie("rangeability") == ""|| getCookie("rangeability") == "0"){
                maxValue = null;
                minValue = null;
            }else if(getCookie("rangeability") < 0){
            	maxValue = -getCookie("rangeability") ;
                minValue = getCookie("rangeability") ;
            }else{
            	maxValue = getCookie("rangeability") ;
                minValue = -getCookie("rangeability") ;
            }
			
			var cellTime = $!cellectTime;
			var monitorname;
			var obj = document.getElementById("monitorlineid");
			monitorname = obj.options[obj.selectedIndex].text;
			var chart = new Highcharts.Chart({
	            chart: {
					backgroundColor: '#ffffff',
					borderColor: '#ffffff',
	                renderTo: 'container',
					plotBackgroundColor: '#ffffff',
	                defaultSeriesType: 'line', //图表类别，可取值有：line、spline、area、areaspline、bar、column等
	                marginRight: 20,
	                marginBottom: 40
	            },
	            title: {
	                text: monitorname + '沉降曲线图', //设置一级标题
	                x: -40, //center
	                y: 20
	            },
	            subtitle: {
	                text:'时间：' + cellTime[0], //设置二级标题
	                x: -40,
	                y: 40
	            },
	            scrollbar: {
	                enabled: false
	            },
	            credits: { 
                    enabled: false
                }, //是否显示版权信息
	            xAxis: {
	            	 categories: $!sensor_name,//设置x轴的标题
                     minTickInterval: 100,
                     minorTickInterval: 100,
                     minorTickPosition: 2500,
                     tickInterval: 1,
                     max: x_Axis
	            },
	            yAxis: {
	            	max: maxValue,
	            	min: minValue,
	                title: {
	                    text: "形变值"//设置y轴的标题
	                },
	                plotLines: [{
	                    value: 0,
	                    width: 1,
	                    color: '#808080'
	                }]
	            },
	            lang:{
		            months:['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],
		            shortMonths:['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],
		            weekdays:['星期天','星期一','星期二','星期三','星期四','星期五','星期六'],
		            exportButtonTitle:'导出PDF',
		            printButtonTitle:'打印图片'
		        },
	            legend: {
	            	layout: 'vertical',
                    align: 'top', //设置说明文字的文字 left/right/top/
                    verticalAlign: 'top',
                    x: 45,
                    borderWidth: 0
	            },
	            plotOptions: {
	                line: {
	                    dataLabels: {
	                        enabled: true //显示每条曲线每个节点的数据项的值
	                    },
	                    enableMouseTracking: false
	                }
	            },
	            series: [{
	                name: '本次沉降值', //每条线的名称
	                data: $!sinkingData//每条线的数据
	            },{
	            	name: '累计沉降值', //每条线的名称
               		data: $!sinkingAccumulation//每条线的数据
         		},{
	            	name: '初始值', //每条线的名称
               		data: $!initData//每条线的数据
         		}/* ,{
                    name: 'Tokyo',
                    data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 25.2]
                }  */
         		]
	        });
		});
	#end
#end

function generateSinkingDataLine(){
	var sensorTypeName = document.getElementById("sensorTypeName").value;
	if(sensorTypeName == ""){
		alert("请选择传感器类型和监测线!");
		return;
	}
	var monitorlineid = document.getElementById("monitorlineid").value;
	if(monitorlineid == ""){
		alert("请选择监测线!");
		return;
	}
	var rangeability = document.getElementById("rangeability").value;
    setCookie('rangeability',rangeability);
	
	document.ListForm.submit();
}

function createDataLine(){
    var sensorTypeName = document.getElementById("sensorTypeName").value;
    if(sensorTypeName == ""){
        alert("请选择传感器类型和监测线!");
        return;
    }
    
    var rangeability = document.getElementById("rangeability").value;
    if(rangeability==""){
        rangeability = 20;
    }else{
        rangeability = parseInt(rangeability);//通过document.getElementById.value拿到的是字符串，在这里转为数字类型
    }

    var i= 0;
    jQuery.post("$!webPath/createLine.htm",{"sensorType":sensorTypeName},function(data){
    	var length = data.length;
    	jQuery("#container").empty();
        jQuery.each(data, function(index,item){
        	var size = parseInt(100/length);
            jQuery("#container").append("<div style='width:18%;height:530px;float:left;border:1px solid #5599FF;margin:9px 0.3% 9px 1.2%;' id=offset"+ i +"><p>"+ i +"</p></div>");

        	var x_Axis = item.sinkingData;
            if( x_Axis.length <= 20){
                x_Axis = x_Axis.length;
            }else{
                x_Axis = 20;
            }
            var cellTime = item.cellectTime;
            var dataTmp = "";
            dataTmp += "{name: '偏移值',color:'#FF7744 ',data:" + item.sinkingData + "}" + ","  ;
            //alert(dataTmp);
            var chart = new Highcharts.Chart({
                chart: {
                    inverted: true,        //x与Y轴反转
                    renderTo: 'offset' + i,
                    defaultSeriesType: 'line', //图表类别，可取值有：line、spline、area、areaspline、bar、column等
                    marginRight: 20,
                    marginBottom: 40
                },
                title: {
                    text: item.monitorName + '偏移图', //设置一级标题
                    x: 5, 
                    y: 30
                },
                subtitle: {
                    text:'时间：' + cellTime, //设置二级标题
                    x: 10,
                    y: 45
                },
                /* scrollbar: {
                    enabled: true
                }, */
                credits: { 
                    enabled: false
                }, //是否显示版权信息
                xAxis: {
                	labels: {
                        formatter: function() {
                            return this.value + 1;
                        }
                    },
                    lineColor:'#800080',//x轴颜色
                	tickInterval: 1,
                	reversed: false,
                },
                yAxis: {
                	tickInterval:rangeability/2,
                    max:rangeability,
                    min:-rangeability,
                	title: {
                        text: '偏移量(mm)',
                     },
                     labels: {
                        formatter: function () {
                           return this.value;
                        }
                     },
   //                  gridLineColor: '   #800080 '
                },
                lang:{
                    months:['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],
                    shortMonths:['一月','二月','三月','四月','五月','六月','七月','八月','九月','十月','十一月','十二月'],
                    weekdays:['星期天','星期一','星期二','星期三','星期四','星期五','星期六'],
                    exportButtonTitle:'导出PDF',
                    printButtonTitle:'打印图片'
                },
                legend: {
                	layout: 'vertical',
                    align: 'top', //设置说明文字的文字 left/right/top/
                    verticalAlign: 'top',
                    x: -10,
                    y: -10,
                    borderWidth: 0
                },
                plotOptions: {
                    line: {
                        dataLabels: {
                            enabled: true //显示每条曲线每个节点的数据项的值
                        },
                        enableMouseTracking: false
                    }
                },
                series: eval("[" + dataTmp + "]") 
            });
            i++;
        });
    }, "json");
}
	
</script>

<script>
//写cookies
function setCookie(c_name, value, expiredays){
 　　　　var exdate=new Date();
　　　　exdate.setDate(exdate.getDate() + expiredays);
　　　　document.cookie=c_name+ "=" + escape(value) + ((expiredays==null) ? "" : ";expires="+exdate.toGMTString());
 　　}
 
//读取cookies
function getCookie(name)
{
    var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");
 
    if(arr=document.cookie.match(reg))
 
        return (arr[2]);
    else
        return null;
}
 
//删除cookies
function delCookie(name)
{
    var exp = new Date();
    exp.setTime(exp.getTime() - 1);
    var cval=getCookie(name);
    if(cval!=null)
        document.cookie= name + "="+cval+";expires="+exp.toGMTString();
}


		
			jQuery(document).ready(function() {
				App.setPage("Home"); //Set current page
				App.init(); //Initialise plugins and elements
			});
		</script>
		<!-- /JAVASCRIPTS -->
	</body>
</html>
